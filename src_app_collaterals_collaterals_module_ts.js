"use strict";(self.webpackChunkmifosx_web_app=self.webpackChunkmifosx_web_app||[]).push([["src_app_collaterals_collaterals_module_ts"],{10495:(q,E,o)=>{o.r(E),o.d(E,{CollateralsModule:()=>W});var b=o(60177),D=o(13721),v=o(92602),I=o(26044),c=o(46661),T=o(25532),t=o(17705),f=o(21626);let p=(()=>{class a{constructor(e){this.http=e}getFilteredClients(e,n,l,m,F){let d=(new f.Nl).set("displayName",m).set("orphansOnly",l.toString()).set("sortOrder",n).set("orderBy",e);return F&&(d=d.set("officeId",F)),this.http.get("/clients",{params:d})}getClientCollateral(e,n){return this.http.get(`/clients/${e}/collaterals/${n}`)}updateClientCollateral(e,n,l){return this.http.put(`/clients/${e}/collaterals/${n}`,l)}deleteCollateral(e,n){return this.http.delete(`/clients/${e}/collaterals/${n}`)}static{this.\u0275fac=function(n){return new(n||a)(t.KVO(f.Qq))}}static{this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var $=o(75351),y=o(20060),g=o(88834),u=o(25596),i=o(9159),M=o(94587),R=o(68018),j=o(53468),k=o(56617);const V=function(){return["edit"]};function P(a,r){1&a&&(t.j41(0,"button",16),t.EFF(1,"\n    "),t.nrm(2,"fa-icon",17),t.EFF(3),t.nI1(4,"translate"),t.k0s()),2&a&&(t.Y8G("routerLink",t.lJ4(4,V)),t.R7$(3),t.SpI("\n    ",t.bMT(4,2,"labels.buttons.Edit"),"\n  "))}function L(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){t.eBV(e);const l=t.XpG();return t.Njj(l.deleteCollateral())}),t.EFF(1,"\n    "),t.nrm(2,"fa-icon",19),t.EFF(3),t.nI1(4,"translate"),t.k0s()}2&a&&(t.R7$(3),t.SpI("\n    ",t.bMT(4,1,"labels.buttons.Delete"),"\n  "))}function O(a,r){1&a&&(t.j41(0,"th",20),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&a&&(t.R7$(1),t.JRh(t.bMT(2,1,"labels.inputs.ID")))}function w(a,r){if(1&a&&(t.j41(0,"td",21),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.R7$(1),t.SpI("\n            ",e.loanId,"\n          ")}}function x(a,r){1&a&&(t.j41(0,"th",20),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&a&&(t.R7$(1),t.JRh(t.bMT(2,1,"labels.inputs.Last Repayment")))}function N(a,r){if(1&a&&(t.j41(0,"td",21),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.R7$(1),t.JRh(e.lastRepayment)}}function S(a,r){1&a&&(t.j41(0,"th",20),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&a&&(t.R7$(1),t.JRh(t.bMT(2,1,"labels.inputs.Remaining Amount")))}function J(a,r){if(1&a&&(t.j41(0,"td",21),t.EFF(1),t.nI1(2,"formatNumber"),t.k0s()),2&a){const e=r.$implicit;t.R7$(1),t.JRh(t.bMT(2,1,e.remainingAmount))}}function Y(a,r){1&a&&(t.j41(0,"th",20),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&a&&(t.R7$(1),t.JRh(t.bMT(2,1,"labels.inputs.Last Repayment Date")))}function G(a,r){if(1&a&&(t.j41(0,"td",21),t.EFF(1),t.nI1(2,"dateFormat"),t.k0s()),2&a){const e=r.$implicit;t.R7$(1),t.JRh(t.bMT(2,1,e.lastRepaymentDate))}}function U(a,r){1&a&&t.nrm(0,"tr",22)}function X(a,r){1&a&&t.nrm(0,"tr",23)}let B=(()=>{class a{constructor(e,n,l,m){this.route=e,this.collateralsService=n,this.router=l,this.dialog=m,this.collateralColumns=["ID","Last Repayment","Remaining Amount","Last Repayment Date"],this.route.data.subscribe(F=>{this.clientCollateralData=F.clientCollateralData})}deleteCollateral(){this.dialog.open(T.X,{data:{deleteContext:`collateral ${this.clientCollateralData.id}`}}).afterClosed().subscribe(n=>{n.delete&&this.collateralsService.deleteCollateral(this.clientCollateralData.clientId,this.clientCollateralData.id).subscribe(()=>{this.router.navigate(["../../"],{relativeTo:this.route})})})}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(c.nX),t.rXU(p),t.rXU(c.Ix),t.rXU($.bZ))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["mifosx-view-collateral"]],decls:78,vars:27,consts:[[1,"layout-row","align-end","gap-2px","responsive-column","container","m-b-20"],["mat-raised-button","","color","primary",3,"routerLink",4,"mifosxHasPermission"],["mat-raised-button","","color","warn",3,"click",4,"mifosxHasPermission"],[1,"client-collateral-card"],[1,"content"],[1,"tab-container","mat-typography"],[1,"layout-row","gap-32px","group-details-container","m-b-30"],["mat-table","",1,"mat-elevation-z1","m-b-30",3,"dataSource"],["matColumnDef","ID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Last Repayment"],["matColumnDef","Remaining Amount"],["matColumnDef","Last Repayment Date"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-raised-button","","color","primary",3,"routerLink"],["icon","edit",1,"m-r-10"],["mat-raised-button","","color","warn",3,"click"],["icon","trash",1,"m-r-10"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(n,l){1&n&&(t.j41(0,"div",0),t.EFF(1,"\n  "),t.DNE(2,P,5,5,"button",1),t.EFF(3,"\n  "),t.DNE(4,L,5,3,"button",2),t.EFF(5,"\n"),t.k0s(),t.EFF(6,"\n\n"),t.j41(7,"mat-card",3),t.EFF(8,"\n  "),t.j41(9,"mat-card-content",4),t.EFF(10,"\\\n\n    "),t.j41(11,"div",5),t.EFF(12,"\n      "),t.j41(13,"h3"),t.EFF(14),t.nI1(15,"translate"),t.k0s(),t.EFF(16,"\n\n      "),t.j41(17,"div",6),t.EFF(18,"\n        "),t.j41(19,"p"),t.EFF(20),t.nI1(21,"translate"),t.nrm(22,"br"),t.EFF(23),t.nI1(24,"translate"),t.nrm(25,"br"),t.EFF(26),t.nI1(27,"translate"),t.nrm(28,"br"),t.EFF(29),t.nI1(30,"translate"),t.nrm(31,"br"),t.EFF(32,"\n        "),t.k0s(),t.EFF(33,"\n      "),t.k0s(),t.EFF(34,"\n\n      "),t.j41(35,"h3"),t.EFF(36),t.nI1(37,"translate"),t.k0s(),t.EFF(38,"\n\n      "),t.j41(39,"table",7),t.EFF(40,"\n        "),t.qex(41,8),t.EFF(42,"\n          "),t.DNE(43,O,3,3,"th",9),t.EFF(44,"\n          "),t.DNE(45,w,2,1,"td",10),t.EFF(46,"\n        "),t.bVm(),t.EFF(47,"\n\n        "),t.qex(48,11),t.EFF(49,"\n          "),t.DNE(50,x,3,3,"th",9),t.EFF(51,"\n          "),t.DNE(52,N,2,1,"td",10),t.EFF(53,"\n        "),t.bVm(),t.EFF(54,"\n\n        "),t.qex(55,12),t.EFF(56,"\n          "),t.DNE(57,S,3,3,"th",9),t.EFF(58,"\n          "),t.DNE(59,J,3,3,"td",10),t.EFF(60,"\n        "),t.bVm(),t.EFF(61,"\n\n        "),t.qex(62,13),t.EFF(63,"\n          "),t.DNE(64,Y,3,3,"th",9),t.EFF(65,"\n          "),t.DNE(66,G,3,3,"td",10),t.EFF(67,"\n        "),t.bVm(),t.EFF(68,"\n\n        "),t.EFF(69,"\n        "),t.DNE(70,U,1,0,"tr",14),t.EFF(71,"\n        "),t.DNE(72,X,1,0,"tr",15),t.EFF(73,"\n      "),t.k0s(),t.EFF(74,"\n    "),t.k0s(),t.EFF(75,"\n  "),t.k0s(),t.EFF(76,"\n"),t.k0s(),t.EFF(77,"\n")),2&n&&(t.R7$(2),t.Y8G("mifosxHasPermission","UPDATE_CLIENT_COLLATERAL_PRODUCT"),t.R7$(2),t.Y8G("mifosxHasPermission","DELETE_CLIENT_COLLATERAL_PRODUCT"),t.R7$(10),t.JRh(t.bMT(15,15,"labels.heading.Client Collateral Details")),t.R7$(6),t.Lme("\n          ",t.bMT(21,17,"labels.inputs.name"),": ",l.clientCollateralData.name,""),t.R7$(3),t.Lme("\n          ",t.bMT(24,19,"labels.inputs.Quantity"),": ",l.clientCollateralData.quantity,""),t.R7$(3),t.Lme("\n          ",t.bMT(27,21,"labels.inputs.Total Value"),": ",l.clientCollateralData.total,""),t.R7$(3),t.Lme("\n          ",t.bMT(30,23,"labels.inputs.Total Collateral Value"),": ",l.clientCollateralData.totalCollateral,""),t.R7$(7),t.JRh(t.bMT(37,25,"labels.heading.Transaction Details")),t.R7$(3),t.Y8G("dataSource",l.clientCollateralData.loanTransactionData),t.R7$(31),t.Y8G("matHeaderRowDef",l.collateralColumns),t.R7$(2),t.Y8G("matRowDefColumns",l.collateralColumns))},dependencies:[c.Wk,y.aY,g.$z,u.RN,u.m2,i.Zl,i.tL,i.ji,i.cC,i.YV,i.iL,i.KS,i.$R,i.YZ,i.NB,M.p,R.D9,j.a,k.p],styles:[".client-collateral-card[_ngcontent-%COMP%]{margin:0 auto;max-width:80rem;width:90%;padding:0}.tab-container[_ngcontent-%COMP%]{padding:1%;margin:1%}.tab-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1% auto}.tab-container[_ngcontent-%COMP%]   .group-details-container[_ngcontent-%COMP%]{border:1px solid;padding:1%}.tab-container[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-left:auto}.tab-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.tab-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .account-action-button[_ngcontent-%COMP%]{min-width:26px;padding:0 6px;margin:4px;line-height:25px}.tab-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.select-row[_ngcontent-%COMP%]:hover, .tab-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return a})(),C=(()=>{class a{constructor(e){this.collateralsService=e}resolve(e){const n=e.parent.paramMap.get("clientId"),l=e.parent.paramMap.get("collateralId");return this.collateralsService.getClientCollateral(n,l)}static{this.\u0275fac=function(n){return new(n||a)(t.KVO(p))}}static{this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac})}}return a})();var s=o(89417),A=o(52864),h=o(32102),H=o(59042);function z(a,r){1&a&&(t.j41(0,"mat-error"),t.EFF(1),t.nI1(2,"translate"),t.nI1(3,"translate"),t.j41(4,"strong"),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.EFF(7,"\n              "),t.k0s()),2&a&&(t.R7$(1),t.Lme("\n                ",t.bMT(2,3,"labels.inputs.Quantity")," ",t.bMT(3,5,"labels.commons.is"),"\n                "),t.R7$(4),t.JRh(t.bMT(6,7,"labels.commons.required")))}const Q=function(){return["../../"]},K=[{path:"",data:{title:"Collateral",breadcrumb:"Collateral",routeParamBreadcrumb:!1},children:[{path:":collateralId",data:{title:"Collateral View",routeParamBreadcrumb:"collateralId"},children:[{path:"",component:B,resolve:{clientCollateralData:C}},{path:"edit",data:{title:"edit",routeParamBreadcrumb:"edit"},component:(()=>{class a{constructor(e,n,l,m,F){this.formBuilder=e,this.route=n,this.router=l,this.settingsService=m,this.collateralService=F,this.route.data.subscribe(d=>{this.collateralDetails=d.clientCollateralData}),this.clientId=this.route.parent.snapshot.params.clientId}ngOnInit(){this.createClientCollateralForm()}createClientCollateralForm(){this.clientCollateralForm=this.formBuilder.group({quantity:["",s.k0.required],name:[{value:"",disabled:!0}],total:[{value:"",disabled:!0}],totalCollateral:[{value:"",disabled:!0}]}),this.clientCollateralForm.patchValue({name:this.collateralDetails.name,quantity:this.collateralDetails.quantity,total:this.collateralDetails.total,totalCollateral:this.collateralDetails.totalCollateral})}submit(){this.collateralService.updateClientCollateral(this.clientId,this.collateralDetails.id,{quantity:this.clientCollateralForm.value.quantity,locale:this.settingsService.language.code}).subscribe(()=>{this.router.navigate(["../"],{relativeTo:this.route})})}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(s.ze),t.rXU(c.nX),t.rXU(c.Ix),t.rXU(A.h),t.rXU(p))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["mifosx-edit-collateral"]],decls:67,vars:23,consts:[[1,"container"],[3,"formGroup","ngSubmit"],[1,"layout-column"],["matInput","","required","","formControlName","name"],["matInput","","required","","formControlName","quantity"],[4,"ngIf"],["matInput","","required","","formControlName","total"],["matInput","","required","","formControlName","totalCollateral"],[1,"layout-row","layout-xs-column","layout-align-center","gap-5px"],["type","button","mat-raised-button","",3,"routerLink"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(n,l){1&n&&(t.j41(0,"div",0),t.EFF(1,"\n  "),t.j41(2,"mat-card"),t.EFF(3,"\n    "),t.j41(4,"form",1),t.bIt("ngSubmit",function(){return l.submit()}),t.EFF(5,"\n      "),t.j41(6,"mat-card-content"),t.EFF(7,"\n        "),t.j41(8,"div",2),t.EFF(9,"\n          "),t.j41(10,"div",2),t.EFF(11,"\n            "),t.j41(12,"mat-form-field"),t.EFF(13,"\n              "),t.j41(14,"mat-label"),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.EFF(17,"\n              "),t.nrm(18,"input",3),t.EFF(19,"\n            "),t.k0s(),t.EFF(20,"\n\n            "),t.j41(21,"mat-form-field"),t.EFF(22,"\n              "),t.j41(23,"mat-label"),t.EFF(24),t.nI1(25,"translate"),t.k0s(),t.EFF(26,"\n              "),t.nrm(27,"input",4),t.EFF(28,"\n              "),t.DNE(29,z,8,9,"mat-error",5),t.EFF(30,"\n            "),t.k0s(),t.EFF(31,"\n\n            "),t.j41(32,"mat-form-field"),t.EFF(33,"\n              "),t.j41(34,"mat-label"),t.EFF(35),t.nI1(36,"translate"),t.k0s(),t.EFF(37,"\n              "),t.nrm(38,"input",6),t.EFF(39,"\n            "),t.k0s(),t.EFF(40,"\n\n            "),t.j41(41,"mat-form-field"),t.EFF(42,"\n              "),t.j41(43,"mat-label"),t.EFF(44),t.nI1(45,"translate"),t.k0s(),t.EFF(46,"\n              "),t.nrm(47,"input",7),t.EFF(48,"\n            "),t.k0s(),t.EFF(49,"\n          "),t.k0s(),t.EFF(50,"\n        "),t.k0s(),t.EFF(51,"\n      "),t.k0s(),t.EFF(52,"\n\n      "),t.j41(53,"mat-card-actions",8),t.EFF(54,"\n        "),t.j41(55,"button",9),t.EFF(56),t.nI1(57,"translate"),t.k0s(),t.EFF(58,"\n        "),t.j41(59,"button",10),t.EFF(60),t.nI1(61,"translate"),t.k0s(),t.EFF(62,"\n      "),t.k0s(),t.EFF(63,"\n    "),t.k0s(),t.EFF(64,"\n  "),t.k0s(),t.EFF(65,"\n"),t.k0s(),t.EFF(66,"\n")),2&n&&(t.R7$(4),t.Y8G("formGroup",l.clientCollateralForm),t.R7$(11),t.JRh(t.bMT(16,10,"labels.inputs.name")),t.R7$(9),t.JRh(t.bMT(25,12,"labels.inputs.Quantity")),t.R7$(5),t.Y8G("ngIf",l.clientCollateralForm.controls.quantity.hasError("required")),t.R7$(6),t.JRh(t.bMT(36,14,"labels.inputs.Total")),t.R7$(9),t.JRh(t.bMT(45,16,"labels.inputs.Total Collateral Value")),t.R7$(11),t.Y8G("routerLink",t.lJ4(22,Q)),t.R7$(1),t.SpI("\n          ",t.bMT(57,18,"labels.buttons.Cancel"),"\n        "),t.R7$(3),t.Y8G("disabled",!l.clientCollateralForm.valid),t.R7$(1),t.SpI("\n          ",t.bMT(61,20,"labels.buttons.Submit"),"\n        "))},dependencies:[b.bT,c.Wk,g.$z,u.RN,u.YY,u.m2,h.rl,h.nJ,h.TL,H.fg,s.qT,s.me,s.BC,s.cb,s.YS,s.j4,s.JD,R.D9],styles:[".container[_ngcontent-%COMP%]{width:37rem}"]})}}return a})(),resolve:{clientCollateralData:C}}]}]}];let Z=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({providers:[C],imports:[c.iI.forChild(K),c.iI]})}}return a})(),W=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[b.MD,Z,v.G,D.h,I.Y]})}}return a})()}}]);